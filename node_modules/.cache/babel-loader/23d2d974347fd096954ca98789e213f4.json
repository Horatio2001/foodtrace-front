{"remainingRequest":"/Users/horatio/WebstormProjects/foodtrace/node_modules/babel-loader/lib/index.js!/Users/horatio/WebstormProjects/foodtrace/node_modules/eslint-loader/index.js??ref--13-0!/Users/horatio/WebstormProjects/foodtrace/src/store/modules/user.js","dependencies":[{"path":"/Users/horatio/WebstormProjects/foodtrace/src/store/modules/user.js","mtime":1682508728827},{"path":"/Users/horatio/WebstormProjects/foodtrace/babel.config.js","mtime":1682417590235},{"path":"/Users/horatio/WebstormProjects/foodtrace/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/horatio/WebstormProjects/foodtrace/node_modules/babel-loader/lib/index.js","mtime":456789000000},{"path":"/Users/horatio/WebstormProjects/foodtrace/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQgfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJwogIH07Cn07CnZhciBzdGF0ZSA9IGdldERlZmF1bHRTdGF0ZSgpOwp2YXIgbXV0YXRpb25zID0gewogIFJFU0VUX1NUQVRFOiBmdW5jdGlvbiBSRVNFVF9TVEFURShzdGF0ZSkgewogICAgT2JqZWN0LmFzc2lnbihzdGF0ZSwgZ2V0RGVmYXVsdFN0YXRlKCkpOwogIH0sCiAgU0VUX1RPS0VOOiBmdW5jdGlvbiBTRVRfVE9LRU4oc3RhdGUsIHRva2VuKSB7CiAgICBzdGF0ZS50b2tlbiA9IHRva2VuOwogIH0sCiAgU0VUX05BTUU6IGZ1bmN0aW9uIFNFVF9OQU1FKHN0YXRlLCBuYW1lKSB7CiAgICBzdGF0ZS5uYW1lID0gbmFtZTsKICB9LAogIFNFVF9BVkFUQVI6IGZ1bmN0aW9uIFNFVF9BVkFUQVIoc3RhdGUsIGF2YXRhcikgewogICAgc3RhdGUuYXZhdGFyID0gYXZhdGFyOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgLy8gdXNlciBsb2dpbgogIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihfcmVmLCB1c2VySW5mbykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgdmFyIHVzZXJuYW1lID0gdXNlckluZm8udXNlcm5hbWUsCiAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICBjb25zb2xlLmxvZyh1c2VySW5mbyk7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICBjb21taXQoJ1NFVF9UT0tFTicsIGRhdGEudG9rZW4pOwogICAgICAgIHNldFRva2VuKGRhdGEudG9rZW4pOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgLy8gZ2V0SW5mbyh7IGNvbW1pdCwgc3RhdGUgfSkgewogIC8vICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAvLyAgICAgZ2V0SW5mbyhzdGF0ZS50b2tlbikudGhlbihyZXNwb25zZSA9PiB7CiAgLy8gICAgICAgY29uc3QgeyBkYXRhIH0gPSByZXNwb25zZQogIC8vCiAgLy8gICAgICAgaWYgKCFkYXRhKSB7CiAgLy8gICAgICAgICByZXR1cm4gcmVqZWN0KCdWZXJpZmljYXRpb24gZmFpbGVkLCBwbGVhc2UgTG9naW4gYWdhaW4uJykKICAvLyAgICAgICB9CiAgLy8KICAvLyAgICAgICAvLyBjb25zdCB7IG5hbWUsIGF2YXRhciB9ID0gZGF0YQogIC8vICAgICAgIC8vCiAgLy8gICAgICAgLy8gY29tbWl0KCdTRVRfTkFNRScsIG5hbWUpCiAgLy8gICAgICAgLy8gY29tbWl0KCdTRVRfQVZBVEFSJywgYXZhdGFyKQogIC8vICAgICAgIHJlc29sdmUoZGF0YSkKICAvLyAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogIC8vICAgICAgIHJlamVjdChlcnJvcikKICAvLyAgICAgfSkKICAvLyAgIH0pCiAgLy8gfSwKICAvLyB1c2VyIGxvZ291dAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYyKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0LAogICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAogICAgICAgIHJlc2V0Um91dGVyKCk7CiAgICAgICAgY29tbWl0KCdSRVNFVF9TVEFURScpOwogICAgICAgIHJlc29sdmUoKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHJlbW92ZSB0b2tlbgogIHJlc2V0VG9rZW46IGZ1bmN0aW9uIHJlc2V0VG9rZW4oX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAogICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgIHJlc29sdmUoKTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"names":["login","logout","getToken","setToken","removeToken","resetRouter","getDefaultState","token","name","avatar","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","actions","_ref","userInfo","commit","username","password","console","log","Promise","resolve","reject","trim","then","response","data","catch","error","_ref2","resetToken","_ref3","namespaced"],"sources":["/Users/horatio/WebstormProjects/foodtrace/src/store/modules/user.js"],"sourcesContent":["import { login, logout } from '@/api/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: ''\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  }\n}\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo\n    console.log(userInfo)\n    return new Promise((resolve, reject) => {\n      login({ username: username.trim(), password: password }).then(response => {\n        const { data } = response\n        console.log(response)\n        commit('SET_TOKEN', data.token)\n        setToken(data.token)\n        resolve()\n      }).catch(error => {\n        console.log(error)\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  // getInfo({ commit, state }) {\n  //   return new Promise((resolve, reject) => {\n  //     getInfo(state.token).then(response => {\n  //       const { data } = response\n  //\n  //       if (!data) {\n  //         return reject('Verification failed, please Login again.')\n  //       }\n  //\n  //       // const { name, avatar } = data\n  //       //\n  //       // commit('SET_NAME', name)\n  //       // commit('SET_AVATAR', avatar)\n  //       resolve(data)\n  //     }).catch(error => {\n  //       reject(error)\n  //     })\n  //   })\n  // },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"],"mappings":"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"}]}